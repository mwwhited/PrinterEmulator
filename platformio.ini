[env:megaatmega2560]
platform = atmelavr
board = megaatmega2560
framework = arduino

; Required libraries for MegaDeviceBridge
lib_deps = 
    SPI
    SD
    Wire
    LiquidCrystal

; Build settings for Arduino Mega 2560 with memory optimization
build_flags = 
    -Os
    -DARDUINO_AVR_MEGA2560
    -DF_CPU=16000000L
    -std=gnu++17
    -fno-exceptions
    -fno-rtti
    -ffunction-sections
    -fdata-sections
    -Wl,--gc-sections
    -mcall-prologues

build_unflags = 
    -std=gnu++11

; Monitor settings
monitor_speed = 115200
monitor_filters = 
    default
    time

; Debug configuration
debug_tool = avr-stub
debug_build_flags = -O0 -g3 -ggdb

; Test environment
[env:test]
platform = native
build_flags = 
    -std=gnu++17
    -DUNIT_TEST
    -DRING_BUFFER_SIZE=16
    -DCOMMAND_BUFFER_SIZE=32
    -DEEPROM_BUFFER_SIZE=32
    -DTRANSFER_BUFFER_SIZE=32
    -DMAX_FILENAME_LENGTH=2
test_framework = unity